---
layout: post
title: Filtering with dotCover
categories: []
tags:
- dotCover
status: publish
type: post
published: true
meta:
  _elasticsearch_indexed_on: '2010-07-08 16:34:31'
comments: true
---
<p><a href="http://www.jetbrains.com/dotcover">dotCover</a> allows us to run coverage analysis on our code. However, there are times when we do not want to perform an analysis on certain areas. This could be our test assemblies, certain third-party assemblies or even specific parts of our own project. Since the analysis has an impact on the overall statistics and potentially can take longer, it is often interesting for us to filter certain assemblies or classes out.</p> <p>The figure below shows the coverage report of the default MVC project (yes, yet another MVC example, but it ships in the box and probably the ONLY template with VS that comes with tests). In this case we’re using xUnit for tests, which is mostly to demonstrate that dotCover works with other frameworks, not only MSTest (personally I’ve moved on to MSpec, which dotCover also supports).</p> <p><a href="http://hhariri.files.wordpress.com/2010/11/119.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="1" border="0" alt="1" src="http://hhariri.files.wordpress.com/2010/11/1_thumb5.png" width="364" height="249"></a> </p> <p>If we focus on the Coverage results we can see that there are some areas in grey, which indicate that the corresponding PDB files were missing so coverage could not take place. We can also see other assemblies that have been included in the results yet might not be of interest, such as the test assemblies.</p> <p><a href="http://hhariri.files.wordpress.com/2010/11/216.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="2" border="0" alt="2" src="http://hhariri.files.wordpress.com/2010/11/2_thumb4.png" width="644" height="178"></a> </p> <p>In order to filter these out, we can use the Coverage Filters, which can be accessed via the dotCover menu in the IDE</p> <p><a href="http://hhariri.files.wordpress.com/2010/11/315.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="3" border="0" alt="3" src="http://hhariri.files.wordpress.com/2010/11/3_thumb4.png" width="397" height="249"></a> </p> <p>By default, everything is set to be covered, as shown by the <strong>Everything </strong>entry in the <strong>Allow Filters </strong>tab (which most likely will be renamed to <strong>Included</strong>). Examining this entry (clicking on Edit) we can see that it is composed of three values:</p> <p><a href="http://hhariri.files.wordpress.com/2010/11/415.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="4" border="0" alt="4" src="http://hhariri.files.wordpress.com/2010/11/4_thumb4.png" width="426" height="162"></a> </p> <ul> <li><strong>Module Mask </strong>indicates the project name  <li><strong>Class Mask </strong>indicates the class name  <li><strong>Function Mask </strong>indicates the method name </li></ul> <p>(All entries support wildcards as displayed by the * that appears)</p> <p>We can now uses these patterns to exclude projects, assemblies, namespaces, classes and methods from out tests.</p> <h3>Excluding entire project</h3> <p>Click on <strong>Deny Filters </strong>tab (most likely will be renamed to <strong>Excluded</strong>) and click on <strong>Add</strong>, entering the following information:</p> <p><a href="http://hhariri.files.wordpress.com/2010/11/515.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="5" border="0" alt="5" src="http://hhariri.files.wordpress.com/2010/11/5_thumb4.png" width="426" height="162"></a> </p> <p>Clicking <strong>OK</strong>&nbsp; and re-running the tests, we now see that the entire test assembly has been excluded</p> <h3>Excluding an entire Namespace</h3> <p>We can exclude entire namespaces by setting it in the Class Mask as shown below:</p> <p><a href="http://hhariri.files.wordpress.com/2010/11/613.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="6" border="0" alt="6" src="http://hhariri.files.wordpress.com/2010/11/6_thumb2.png" width="426" height="162"></a> </p> <p>this will exclude all the classes inside the MvcApplication16.Models namespace. If we just wanted a specific class, we add it after Models instead of *.</p> <h3>Excluding a method</h3> <p>We can exclude a method, similar to how we’ve done it with the previous cases:</p> <p><a href="http://hhariri.files.wordpress.com/2010/11/74.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="7" border="0" alt="7" src="http://hhariri.files.wordpress.com/2010/11/7_thumb3.png" width="426" height="162"></a> </p> <p>&nbsp;</p> <p>Adding a series of filters for test and auxiliary assemblies using the previous steps, we can end up with a cleaner and more accurate coverage report:</p> <p><a href="http://hhariri.files.wordpress.com/2010/11/84.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="8" border="0" alt="8" src="http://hhariri.files.wordpress.com/2010/11/8_thumb2.png" width="364" height="249"></a> </p> <p>produced by adding the following filters:</p> <p><a href="http://hhariri.files.wordpress.com/2010/11/95.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="9" border="0" alt="9" src="http://hhariri.files.wordpress.com/2010/11/9_thumb3.png" width="397" height="249"></a> </p> <p>Notice that by using the *.Tests (or alternatively as I call it *.Specifications), we can automatically exclude all our test projects from code coverage.</p> <p>&nbsp;</p> <h3>Beta Disclosure</h3> <p>Note 1: Currently these settings are Global, that is, they apply to all projects. Most likely we’ll be changing it so that they are Solution and Global scoped. This way, common libraries can be excluded for all solutions, and specific projects and/or namespaces can be solution based.</p> <p>Note 2: We’re also looking at adding functionality to make it easier to define these exclusions (a la Right-Click on Folder, add to Excluded list)</p> <p>As always, we’re still in beta and feedback is more than welcome!</p>
