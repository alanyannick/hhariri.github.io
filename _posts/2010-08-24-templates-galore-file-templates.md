---
layout: post
title: 'Templates Galore: File Templates'
categories: []
tags:
- ReSharper
status: publish
type: post
published: true
meta:
  _elasticsearch_indexed_on: '2010-08-24 15:33:29'
comments: true
---
<p>Continuing with <a href="http://hadihariri.com/blogengine/post/2010/08/06/Templates-Galore-Live-Templates.aspx">Templates</a>, in this post we’re going to take a look at File Templates. Whereas Live Templates allow us to generate interactive code and insert this at the current cursor position, File Templates allow us to do the same but directing the output to a file. Additionally, as we’ll see, they are very useful for creating both standard and custom files efficiently.</p>  <p>If we open up the <strong>Templates Explorer </strong>via <a href="http://www.jetbrains.com/resharper"><strong>ReSharper</strong></a><strong>&#160;</strong>| <strong>Live Templates</strong>, we can see three tabs: <strong>Live Templates</strong>, <strong>Surround Templates </strong>and <strong>File Templates</strong>.</p>  <p><a href="http://hhariri.files.wordpress.com/2010/11/imagede55.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="imagede55" border="0" alt="imagede55" src="http://hhariri.files.wordpress.com/2010/11/imagede55_thumb.png" width="445" height="381" /></a> </p>  <p>Similar to Live Templates, Files are organized into different categories, corresponding to the type and language of a project. By default the predefined ones include templates for Web Applications (ASP.NET) and generic applications (Console, WinForm, Libraries, etc.). There are also User defined ones as well as Shared Solution and Personal Solution, again similar to Live Templates.</p>  <p>On the right-hand column we have a repeated set of templates. What these allow us to do is customize the usage of templates. However, before seeing that and delving into creating new templates, let’s see how we can use the existing ones.</p>  <h3>Using Templates in Web Applications</h3>  <p>1. Create a new Web Application (can be MVC or WebForms) to work with.</p>  <p>2. There are multiple ways to create new file templates with ReSharper (right-click <strong>Solution Explorer |Add | New From Template</strong> or via the <strong>ReSharper | Edit | New From Template menu</strong>). However, by far one of the easiest and most efficient ways is what we introduced in ReSharper 5: <strong>Create New File</strong>. You can invoke this from anywhere, be it the Solution Explorer or from a file in the editor, by pressing <strong>Ctrl+Alt+Ins</strong></p>  <p><a href="http://hhariri.files.wordpress.com/2010/11/image7cc0.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="image7cc0" border="0" alt="image7cc0" src="http://hhariri.files.wordpress.com/2010/11/image7cc0_thumb.png" width="244" height="237" /></a>&#160;&#160; <br />[Pressing Ctrl+Alt+Ins in ASPX editor]</p>  <p>&#160;</p>  <p><a href="http://hhariri.files.wordpress.com/2010/11/imagef31f.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="imagef31f" border="0" alt="imagef31f" src="http://hhariri.files.wordpress.com/2010/11/imagef31f_thumb.png" width="238" height="273" /></a>&#160;&#160; <br />[Pressing Ctrl+Alt+Ins in Solution Explorer]</p>  <p>Since this is a Web Application, the list of Templates to choose from include all those that appeared under ASP.NET Projects in the Template Explorer. In addition, since creating a Class, Interface, Struct or Enum are still valid in the context, it will display those too.</p>  <p>3. Select a new file, for instance <strong>Web form with master page </strong>and provide it with a name and hit OK (Enter key)</p>  <p><a href="http://hhariri.files.wordpress.com/2010/11/image75dd.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="image75dd" border="0" alt="image75dd" src="http://hhariri.files.wordpress.com/2010/11/image75dd_thumb.png" width="315" height="117" /></a> </p>  <p>4. Based on the type of file, and in particular the template it contains, we will be prompted for additional information. In this case since we requested a Web Form with a MasterPage, ReSharper prompts for the MasterPage file</p>  <p><a href="http://hhariri.files.wordpress.com/2010/11/image50f9.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="image50f9" border="0" alt="image50f9" src="http://hhariri.files.wordpress.com/2010/11/image50f9_thumb.png" width="469" height="83" /></a> </p>  <p>5. Select the corresponding master page and hit Enter.</p>  <p>We’re done. With very little effort, we’ve created a new Web Page and referenced the Master Page. Comparing that to the default way of creating Web Forms (or in fact any other item) in Visual Studio, we can quickly see how much more efficient it can be. However, the true power of this lies in it’s customization, not only in the template but also in what templates we can choose from.</p>  <h3>Customizing the Files we care about</h3>  <p>When invoking the <strong>Create New File</strong>, the list that appears is customizable, both in regard to the contents as well as the ordering. Imagine for instance that we usually work with MVC applications and Spark View Engine and are not really interested in WebForms. Having things like Web Control or Web Form with master page pop-up only add noise to the options. Fortunately we can eliminate these easily:</p>  <p>1. Open up the <strong>Templates Explorer </strong>editor via <strong>ReSharper | Live Templates</strong> and select<strong> File Templates</strong></p>  <p>2. Select the element we don’t want to appear when creating a new File Template. In this case we want to eliminate <em>Web Controls </em>and <em>Web form xxxx</em></p>  <p><a href="http://hhariri.files.wordpress.com/2010/11/image99f6.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="image99f6" border="0" alt="image99f6" src="http://hhariri.files.wordpress.com/2010/11/image99f6_thumb.png" width="422" height="196" /></a> </p>  <p>3. Click on the red cross (X)</p>  <p>4. Close the Templates Explorer</p>  <p>5. Invoke the Create New File menu by pressing Ctrl+Alt+Ins. It should now only display the remaining entries.</p>  <p><a href="http://hhariri.files.wordpress.com/2010/11/image2850.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="image2850" border="0" alt="image2850" src="http://hhariri.files.wordpress.com/2010/11/image2850_thumb.png" width="313" height="213" /></a> </p>  <p>Apart from eliminating entries, we can also change the sort order by dragging the entries in the Templates Explorer (right-hand column, same place we selected to delete in step 2) up and down.</p>  <h3>Creating new File Templates</h3>  <p>Being able to generate templates fast, customize them and edit them wouldn’t be sufficient if we couldn’t also create new ones. Fortunately, we can. Let’s see how we can easily create simple DTO objects that use for instance the <em>DataContract </em>and <em>DataMember </em>attributes.</p>  <p>1. Create a new project. Any type will do.</p>  <p>2. Open <strong>Templates Explorer </strong>via <strong>ReSharper | <strong>Live Templates </strong>and click on <strong>File Templates</strong></strong> </p>  <p>3. Select the User Templates node and right-click to create <strong>New Template</strong></p>  <p><a href="http://hhariri.files.wordpress.com/2010/11/a.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="a" border="0" alt="a" src="http://hhariri.files.wordpress.com/2010/11/a_thumb.png" width="328" height="238" /></a> </p>  <p>3. In the Template Editor, type DTO for the Description and NewDTO.cs for the file name</p>  <p>4. Enter the following in the Editor</p>  <p><a href="http://hhariri.files.wordpress.com/2010/11/b.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="b" border="0" alt="b" src="http://hhariri.files.wordpress.com/2010/11/b_thumb.png" width="357" height="247" /></a> </p>  <p>We now need to define some macros on the placeholders (variables $nameSpace$, $className$, etc.).</p>  <p>Note: The first [DataMember] property we’ve added is of course optional and more for demonstration purposes.</p>  <p>5. Select the <strong>nameSpace </strong>placeholder in the right-hand column and for the value choose “<strong>Default namespace for current file</strong>”</p>  <p>6. Select the className placeholder in the right-hand column and for the value choose “<strong>Current file name without extension</strong>”</p>  <p>7. Uncheck the <strong>Editable Occurrence </strong>on previous two entries. This prevents ReSharper prompting us for values</p>  <p>8. Save changes and close the editor</p>  <h3>Using the new File Template </h3>  <p>We saw that File Templates can be invoked using Ctrl+Alt+Ins (<strong>Create New File). </strong>However if we do this now, our template will not appear. That is because we need to tell ReSharper we want it on this quick list. We can do this in two ways:</p>  <p><em>Method 1: </em>Invoke the template using an alternative option, for instance <strong>ReSharper | Edit | New From Template </strong>and selecting <strong>More..</strong></p>  <p><a href="http://hhariri.files.wordpress.com/2010/11/c.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="c" border="0" alt="c" src="http://hhariri.files.wordpress.com/2010/11/c_thumb.png" width="377" height="184" /></a> </p>  <p>This will bring up a dialog box with other templates:</p>  <p><a href="http://hhariri.files.wordpress.com/2010/11/d.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="d" border="0" alt="d" src="http://hhariri.files.wordpress.com/2010/11/d_thumb.png" width="197" height="244" /></a> </p>  <p>where we can select our Template. At this point we can tick the CheckBox “Add to quicklist”, selecting the Category from the Dropdown below it.</p>  <p><em>Method 2: </em>Alternatively, we can drag and drop the template from the Template Explorer to the Category we are interested in (for instance C#)</p>  <p><a href="http://hhariri.files.wordpress.com/2010/11/e.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="e" border="0" alt="e" src="http://hhariri.files.wordpress.com/2010/11/e_thumb.png" width="214" height="244" /></a> </p>  <p>Either way we choose, from this point on, our template will now be accessible via Ctrl+Alt+Ins:</p>  <p><a href="http://hhariri.files.wordpress.com/2010/11/f.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="f" border="0" alt="f" src="http://hhariri.files.wordpress.com/2010/11/f_thumb.png" width="244" height="188" /></a> </p>  <h3>Summary</h3>  <p>With File Templates we can easily create files that are used frequently, such as DTO’s, Unit Tests, Controllers or other common classes we create. In addition to providing an efficient way to create these items, we can also interact with them, just like we do with Live Templates to adapt them to our needs on each creation.</p>
