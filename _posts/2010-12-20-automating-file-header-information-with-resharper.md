---
layout: post
title: Automating File Header Information with ReSharper
categories: []
tags:
- ReSharper
status: publish
type: post
published: true
meta:
  reddit: a:2:{s:5:"count";i:0;s:4:"time";i:1385704324;}
  _elasticsearch_indexed_on: '2010-12-20 20:17:19'
comments: true
---
<p>Many OSS projects often have some license information at the top of each file, reminding you of the evils you need to comply with. Some companies also have policies in place that require every single file to have company information. It would be quite cumbersome if one would have to constantly and manually enter this information. Fortunately though, you don’t need to.&nbsp; Let’s examine the various ways to do this.</p> <h3>Inserting File Headers during Code Cleanup</h3> <p><a href="http://www.jetbrains.com/resharper">ReSharper</a> offers the possibility of running code cleanup on your file, project or solution. As it’s name indicates, Code Cleanup can clean up certain aspects of your files, like optimizing using statements, formatting the layout of type members, removing code redundancies, changing explicit type declarations to use <em>var, </em>and much more. </p> <p>One of these options is to insert File Headers. For this, it uses the File Header values defined in <strong>ReSharper | Options | Languages | File Header</strong>. Therefore, the first step to take advantage of this feature is to define the header:</p> <p><a href="http://hhariri.files.wordpress.com/2010/12/snaghtml1028ee97.png"><img style="display:inline;border-width:0;" title="SNAGHTML1028ee97" border="0" alt="SNAGHTML1028ee97" src="http://hhariri.files.wordpress.com/2010/12/snaghtml1028ee97_thumb.png" width="425" height="425"></a></p> <p>We can optionally add a region name in the <strong>Embrace File Header into Region with Name</strong>. By doing so, ReSharper will wrap the header inside a region (currently the File Header is global across solutions). </p> <p>Once we have the header defined, all we need to do is activate the option in the Code Cleanup. We can either activate it in an existing profile or create a new profile specific for Header insertion. To do so, we invoke the Code Clean up (Cltr+E,C in VS Scheme) and select Edit Profiles</p> <p><a href="http://hhariri.files.wordpress.com/2010/12/snaghtml102e43a9.png"><img style="display:inline;border-width:0;" title="SNAGHTML102e43a9" border="0" alt="SNAGHTML102e43a9" src="http://hhariri.files.wordpress.com/2010/12/snaghtml102e43a9_thumb.png" width="425" height="348"></a></p> <p>We then create a new Profile by clicking on <strong>Add</strong>, and giving it a name, for instance <em>File Header Insertion.</em></p> <p><a href="http://hhariri.files.wordpress.com/2010/12/snaghtml102f5fef.png"><img style="display:inline;border-width:0;" title="SNAGHTML102f5fef" border="0" alt="SNAGHTML102f5fef" src="http://hhariri.files.wordpress.com/2010/12/snaghtml102f5fef_thumb.png" width="418" height="418"></a></p> <p>We then need to select all the cleanup operations we want to happen when we run the profile. In our case, we’re exclusively interested in the <strong>Update File Header</strong>. </p> <p>Our newly created profile should now appear as an option when invoking code cleanup. To apply the cleanup to a file, we can invoke it when editing the file or having it selected in the Solution Explorer. To apply to the project, we select the Project. And as expected, selecting the entire Solution will apply the cleanup solution-wide. In our case, we want to apply the licensing to the entire solution</p> <p><a href="http://hhariri.files.wordpress.com/2010/12/image17.png"><img style="display:inline;border-width:0;" title="image" border="0" alt="image" src="http://hhariri.files.wordpress.com/2010/12/image_thumb17.png" width="462" height="265"></a> </p> <p>That’s it. With one action we’ve applied licensing to our entire solution. </p> <h3>Automating File Headers with File Templates</h3> <p>The previous solution works great when we want to apply licensing on a global scale. The downside is that it’s the same across different solutions. What happens if we want to customize it based on project? One other issue is that it does not&nbsp; support any type of macros. As such, we cannot insert values such as the filename or date the file was created. </p> <p>An alternative to this approach could be create file headers when we create the actual files, for which we can use File Templates. (we’ve covered File Templates in details in an <a href="https://hhariri.wordpress.com/2010/08/24/templates-galore-file-templates/">earlier post</a>). Let’s see how we can apply this to class creation. </p> <p>We create a new template under <strong>Shared Solution Templates </strong>in <strong>File Templates</strong></p> <p><a href="http://hhariri.files.wordpress.com/2010/12/image18.png"><img style="display:inline;border-width:0;" title="image" border="0" alt="image" src="http://hhariri.files.wordpress.com/2010/12/image_thumb18.png" width="225" height="116"></a> </p> <p>in this case called <em>Licensed Class</em>. The definition of the template is:</p> <p><a href="http://hhariri.files.wordpress.com/2010/12/snaghtml1128e92f.png"><img style="display:inline;border-width:0;" title="SNAGHTML1128e92f" border="0" alt="SNAGHTML1128e92f" src="http://hhariri.files.wordpress.com/2010/12/snaghtml1128e92f_thumb.png" width="535" height="385"></a></p> <p>which is the default class template, to which we have added a region with the license information and two additional macros: <em>Filename </em>and <em>Date Created</em>. There are corresponding Macros in ReSharper to obtain this information so no need to extend the functionality. We do set the <em>Editable Occurrence </em>of each Macro to false so that ReSharper does not prompt us for values. </p> <p>The final step is to make this template accessible when creating classes (using Cltr+Alt+Ins). To do that, we need to drag it and drop it on the Quicklist as shown </p> <p><a href="http://hhariri.files.wordpress.com/2010/12/image19.png"><img style="display:inline;border-width:0;" title="image" border="0" alt="image" src="http://hhariri.files.wordpress.com/2010/12/image_thumb19.png" width="442" height="265"></a> </p> <p>Now when creating a new file, we get Licensed Class as the first entry</p> <p><a href="http://hhariri.files.wordpress.com/2010/12/image20.png"><img style="display:inline;border-width:0;" title="image" border="0" alt="image" src="http://hhariri.files.wordpress.com/2010/12/image_thumb20.png" width="266" height="250"></a> </p> <p>When we switch to a different solution, the <em>Licensed Class </em>will not be available, so it will not interfere with other solutions were this type of header is not required. Obviously, we could generalize this by modifying the built-in template as well as apply it to other templates (template embedding might be a good feature here!) </p> <p>Like everything, this also has it’s downsides. First of all, you cannot *apply* this to existing classes since it’s on creation. Secondly, if you run code cleanup with a new File Header, it will overwrite the existing one. The one advantage it does have is that you can place that template anywhere you want. So for instance if you prefer your license information to be at the bottom of the file, you can do that.&nbsp; </p> <h3>Using StyleCop for ReSharper to provide Company and Copyright Information</h3> <p>If you’re not familiar with StyleCop, it’s a tool for Microsoft that highlights certain coding styles. <a href="http://twitter.com/#!/howardvrooijen">Howard van Rooijen</a> wrote a plug-in for ReSharper that makes using StyleCop much easier and more interactive. <a href="http://stylecopforresharper.codeplex.com/">Check it out if you’re not familiar with it</a>. </p> <p>One of the *rules* that StyleCop recommends is for files to have headers with information about author/company, etc. When you install StyleCop for ReSharper, it creates some options under ReSharper | Options as well as entries under the Code Cleanup options. </p> <p><a href="http://hhariri.files.wordpress.com/2010/12/snaghtml113a8050.png"><img style="display:inline;border-width:0;" title="SNAGHTML113a8050" border="0" alt="SNAGHTML113a8050" src="http://hhariri.files.wordpress.com/2010/12/snaghtml113a8050_thumb.png" width="412" height="412"></a></p> <p>In order to define the information required, we can right-click on the Project Properties and select StyleCop Settings</p> <p><a href="http://hhariri.files.wordpress.com/2010/12/image21.png"><img style="display:inline;border-width:0;" title="image" border="0" alt="image" src="http://hhariri.files.wordpress.com/2010/12/image_thumb21.png" width="418" height="179"></a> </p> <p>and enter the information under <strong>Company Information</strong></p> <p><a href="http://hhariri.files.wordpress.com/2010/12/snaghtml113c9a07.png"><img style="display:inline;border-width:0;" title="SNAGHTML113c9a07" border="0" alt="SNAGHTML113c9a07" src="http://hhariri.files.wordpress.com/2010/12/snaghtml113c9a07_thumb.png" width="407" height="373"></a></p> <p>By just enable StyleCop for ReSharper, we already get quickfixes on our files to provide header information</p> <p><a href="http://hhariri.files.wordpress.com/2010/12/image22.png"><img style="display:inline;border-width:0;" title="image" border="0" alt="image" src="http://hhariri.files.wordpress.com/2010/12/image_thumb22.png" width="664" height="144"></a> </p> <p>which generates</p> <p><a href="http://hhariri.files.wordpress.com/2010/12/image23.png"><img style="display:inline;border-width:0;" title="image" border="0" alt="image" src="http://hhariri.files.wordpress.com/2010/12/image_thumb23.png" width="505" height="265"></a> </p> <p>and we can apply it globally using the Code Cleanup Options that StyleCop adds</p> <p><a href="http://hhariri.files.wordpress.com/2010/12/image24.png"><img style="display:inline;border-width:0;" title="image" border="0" alt="image" src="http://hhariri.files.wordpress.com/2010/12/image_thumb24.png" width="406" height="330"></a> </p> <p>It is important to note that the license information would need to be provided independently using the <strong>File Header </strong>option of ReSharper. What StyleCop for ReSharper provides is the ability to combine this information with it’s own. </p> <h3>Summary</h3> <p>Based on the type of information we want included, as well as the scope, we can pick one of the different options presented here or combine them when appropriate. Right now the File Header option in ReSharper is slightly limited in the functionality it offers but already suggestions have been made to improve it. If there’s something you’d like, please either log it in <a href="http://youtrack.jetbrains.net/">YouTrack</a> or leave a comment here. </p>
