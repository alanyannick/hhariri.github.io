---
layout: post
title: 'Templates Galore: Live Templates'
categories: []
tags:
- ReSharper
status: publish
type: post
published: true
meta:
  _elasticsearch_indexed_on: '2010-08-06 21:37:30'
comments: true
---
<p>A couple of months ago I was doing a talk at DevSum, Stockholm. It was a room full of developers, 90% of whom had heard of <a href="http://www.jetbrains.com/resharper">ReSharper</a> and 80% of them used it. What surprised me however was that only a couple of folks knew about Live Templates, which left me wondering how many outside of the that group actually knew about them too. Thus, in an attempt to expand the reach, we’ll take a look at what Live Templates and in future posts look at Surround and File Templates</p>  <h3>Snippets on Speed</h3>  <p>Live Templates enhances the Visual Studio Code Snippets by providing more functionality and easier management. To open up the Live Templates manager, we click on the ReSharper menu and select Live Templates:</p>  <p><a href="http://hhariri.files.wordpress.com/2010/11/113.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="1" border="0" alt="1" src="http://hhariri.files.wordpress.com/2010/11/1_thumb1.png" width="266" height="370" /></a> </p>  <p>ReSharper has four groups of templates:</p>  <ul>   <li>Predefined: Predefined by ReSharper </li>    <li>User Templates: Templates defined by the user </li>    <li>Personal Solution Templates: Templates that are specific to a solution </li>    <li>Shared Solution Templates: Templates that are specific to a solution and can be shared with others </li> </ul>  <p>Each group consists of various categories based on the type of project/files we are working on. Many of these also import the default Snippets that are available in Visual Studio. From this screen there are various operations we can perform such as adding, removing, editing templates, as well as importing and them. Editing and Creating Templates is where some of the juice is, so let’s see how we can create a new template.</p>  <h3>Creating Templates</h3>  <p>Templates consists of literal strings and variables. The idea is to combine these to maximize efficiency when typing. They can be used for a variety of things, from creating classes, DTO’s or skeletons for unit tests, among others. Let’s say we like to create entities that usually have an Id field prefixed (this is not personal!) with the name of the class, along with some other properties. The type of my Id is not necessarily known beforehand. It can be of type string, GUID, etc. Here’s a sample:</p>  <div style="display:inline;float:none;margin:0;padding:0;" id="scid:9ce6104f-a9aa-4a17-a79f-3a39532ebf7c:fbbbfd30-49ed-4447-9259-0d05474ee99e" class="wlWriterSmartContent">   <div class="le-pavsc-container">     <div style="background-color:#000000;white-space:nowrap;overflow:auto;padding:2px 5px;"><span style="color:#ffffff;"></span><span style="color:#cc7832;">public</span><span style="color:#ffffff;"> </span><span style="color:#cc7832;">class</span><span style="color:#ffffff;"> </span><span style="color:#ffc66d;">Customer</span>        <br /><span style="color:#ffffff;">{</span>        <br /><span style="color:#ffffff;"></span><span style="color:#cc7832;">public</span><span style="color:#ffffff;"> </span><span style="color:#cc7832;">string</span><span style="color:#ffffff;"> CustomerId { </span><span style="color:#cc7832;">get</span><span style="color:#ffffff;">; </span><span style="color:#cc7832;">private</span><span style="color:#ffffff;"> </span><span style="color:#cc7832;">set</span><span style="color:#ffffff;">; }</span>        <br /><span style="color:#ffffff;"></span><span style="color:#cc7832;">public</span><span style="color:#ffffff;"> </span><span style="color:#cc7832;">string</span><span style="color:#ffffff;"> Name { </span><span style="color:#cc7832;">get</span><span style="color:#ffffff;">; </span><span style="color:#cc7832;">private</span><span style="color:#ffffff;"> </span><span style="color:#cc7832;">set</span><span style="color:#ffffff;">; }</span>        <br /><span style="color:#cc7832;">public</span><span style="color:#ffffff;"> </span><span style="color:#cc7832;">string</span><span style="color:#ffffff;"> Email { </span><span style="color:#cc7832;">get</span><span style="color:#ffffff;">; </span><span style="color:#cc7832;">private</span><span style="color:#ffffff;"> </span><span style="color:#cc7832;">set</span><span style="color:#ffffff;">; }</span>        <br /><span style="color:#ffffff;">}</span></div>      <p>&#160;</p>   </div>    <p>&#160;</p> </div>  <p>Let’s see the step-by-step process to create a template for this:</p>  <p>1. Open up the Live Template Editor and select User Templates</p>  <p>2. Click New Template to add a new template</p>  <p><a href="http://hhariri.files.wordpress.com/2010/11/212.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="2" border="0" alt="2" src="http://hhariri.files.wordpress.com/2010/11/2_thumb1.png" width="167" height="122" /></a> </p>  <p>3. This opens up the editor where we can type our text (literal strings and variables).</p>  <p><a href="http://hhariri.files.wordpress.com/2010/11/312.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="3" border="0" alt="3" src="http://hhariri.files.wordpress.com/2010/11/3_thumb1.png" width="475" height="141" /></a> </p>  <p>4. We need to provide a shortcut for our template, which will be used to invoke it (we’ll see how later). Type “be” in the Shortcut field. In the Description type “Business Entity”</p>  <p>5. Type the following in the text area (black in the figure above)</p>  <p><a href="http://hhariri.files.wordpress.com/2010/11/412.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="4" border="0" alt="4" src="http://hhariri.files.wordpress.com/2010/11/4_thumb1.png" width="407" height="86" /></a> </p>  <p>The different colors have meanings (these Colors can be configured under Tools | Options | Fonts and Color. Look for “ReSharper Live xxxxx” entries). There are 3 types of elements in the text:</p>  <ul>   <li>text literal </li>    <li>template keyword </li>    <li>variables </li> </ul>  <p>The text literal is everything that is in white text, such as “public class” and “{ get; private set;}”. Anything literal will appear as is when we invoke the template. The second type of element is the $END$ keyword. This is used to tell ReSharper where we want the cursor to be positioned once we have finished invoking and interacting with the template. Finally we have the variables. These are elements that can be used to interact with the template. A variable is designated using the $ prefix and suffix. That is, anytime we type a word prefixed and suffixed with a $ sign, ReSharper will automatically convert it to a variable. The effect that this has is that when we invoke the template, we can iterate through the different variables to type a value. In our case, since we want to establish the classname during its invocation, we make the $className$ a variable. The same occurs with $idType$, since we don’t know what type we want the Id to be (this is for demonstration purposes, normally most entities have the same type for their Id). Finally comes the Id property. We said we want this to resemble the classname suffixed with Id. As such we just suffix it with the word Id.</p>  <p>6. Close the Editor.</p>  <p>7. Open up an existing file and locate an empty are where we can create a new class. Now type “b” and we should get Intellisense for all templates that start with “b”. Locate “be” and hit TAB (or ENTER)</p>  <p><a href="http://hhariri.files.wordpress.com/2010/11/512.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="5" border="0" alt="5" src="http://hhariri.files.wordpress.com/2010/11/5_thumb1.png" width="241" height="163" /></a> </p>  <p>ending up with:</p>  <p><a href="http://hhariri.files.wordpress.com/2010/11/610.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="6" border="0" alt="6" src="http://hhariri.files.wordpress.com/2010/11/6_thumb.png" width="385" height="109" /></a> </p>  <p>ReSharper has generated the core code of the template and is now ready for our input. The cursor is currently positioned at className, where can type in the class name. Notice that as we type, the value of the property name is automatically updated, as expected. Once we finish typing className we hit TAB (or ENTER) and ReSharper positions us at the IdType entry where we can type in the type of the property (with the corresponding IntelliseSense).</p>  <p>8. Once the process is complete, we should end up with the following class (for the value “Customer”):</p>  <p><a href="http://hhariri.files.wordpress.com/2010/11/72.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="7" border="0" alt="7" src="http://hhariri.files.wordpress.com/2010/11/7_thumb1.png" width="399" height="111" /></a> </p>  <h3>Classifying the Template</h3>  <p>Currently the newly created template has been classified under “No Languages”. The main issue with this is that this template will be available pretty much everywhere, even places where it wouldn’t make sense to create a new class.</p>  <p><a href="http://hhariri.files.wordpress.com/2010/11/82.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="8" border="0" alt="8" src="http://hhariri.files.wordpress.com/2010/11/8_thumb.png" width="172" height="57" /></a> </p>  <p>Let’s proceed in limiting it in scope and defining a category:</p>  <p>1. Select ReSharper | Live Templates and Click on Edit on the newly created template</p>  <p>2. Select the link at the top of the editor next to the “Available” text</p>  <p><a href="http://hhariri.files.wordpress.com/2010/11/93.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="9" border="0" alt="9" src="http://hhariri.files.wordpress.com/2010/11/9_thumb1.png" width="356" height="77" /></a> </p>  <p>The Template Availability dialog box will appear</p>  <p><a href="http://hhariri.files.wordpress.com/2010/11/103.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="10" border="0" alt="10" src="http://hhariri.files.wordpress.com/2010/11/10_thumb1.png" width="244" height="221" /></a> </p>  <p>3. Select the Language-Specific option and choose C# from the dropdown list. The dialog box should now change to show language specific options:</p>  <p><a href="http://hhariri.files.wordpress.com/2010/11/114.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="11" border="0" alt="11" src="http://hhariri.files.wordpress.com/2010/11/11_thumb1.png" width="207" height="244" /></a> </p>  <p>4. We can now choose the minimum version of the compiler for which this template is available (for example if it contains lambda expressions, we cannot use it versions below 3) and also choose where we want the declaration to be available. In our case we can choose Everywhere.</p>  <p>5. Last thing left to do is define a New Category for this template. We can do this by selecting it in the Live Templates tree, right-clicking and selecting New Category. In our case we would type C#</p>  <p>With this change we restrict where this template will be available and have a better classification when viewing templates.</p>  <h3>Extending Functionality with Macros</h3>  <p>We saw that when multiple instances of a variable appear in the template definition, as one changes, others will update to reflect that change. However, sometimes we might want a slight variation of a specific variable. Say for instance, we are create a template to define a property with a backing field (this template already exists by the way). In this scenario, usually the backing field name is the same as that of the property name with a lowerCamelCase. Let’s see how we can define a template like this using the Macros in the Live Editor Template:</p>  <p>1. Create a new template following the steps outlined previously, ending up with the following definition:</p>  <p><a href="http://hhariri.files.wordpress.com/2010/11/123.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="12" border="0" alt="12" src="http://hhariri.files.wordpress.com/2010/11/12_thumb1.png" width="333" height="317" /></a> </p>  <p>If we were to use this template as is, ReSharper would prompt us to enter a value for $className$, $IdType$ and $backingField$. Ideally what we would like is to have the latter to be a variation of the $className$, concretely, a lowercase version.</p>  <p>2. On the right side of the template editor, there is a Window that displays Macros that we can apply to variables. There is one for each variable. Click on the backingField entry and select the Choose Macro link</p>  <p><a href="http://hhariri.files.wordpress.com/2010/11/133.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="13" border="0" alt="13" src="http://hhariri.files.wordpress.com/2010/11/13_thumb1.png" width="372" height="211" /></a> </p>  <p>A dialog box appears giving us a series of operations we can perform on the variable, from suggestions, conversions, metadata, etc. In our case we need to scroll right to the end and select “Value of another variable with the first character in lower case”:</p>  <p><a href="http://hhariri.files.wordpress.com/2010/11/143.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="14" border="0" alt="14" src="http://hhariri.files.wordpress.com/2010/11/14_thumb1.png" width="231" height="244" /></a> </p>  <p>3. Once we click OK, the Macro window will then be updated to reflect the change and allow us to define the value of the variable. Click “another variable” link and select one className.</p>  <p><a href="http://hhariri.files.wordpress.com/2010/11/153.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="15" border="0" alt="15" src="http://hhariri.files.wordpress.com/2010/11/15_thumb1.png" width="335" height="124" /></a> </p>  <p>4. Save the template.</p>  <p>5. Invoke the template by typing “be” as before. We should end up with:</p>  <p><a href="http://hhariri.files.wordpress.com/2010/11/163.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="16" border="0" alt="16" src="http://hhariri.files.wordpress.com/2010/11/16_thumb1.png" width="351" height="193" /></a> </p>  <p>We can now type the className. As we do, we see that the backing field will automatically update to reflect the changes.</p>  <p><a href="http://hhariri.files.wordpress.com/2010/11/173.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="17" border="0" alt="17" src="http://hhariri.files.wordpress.com/2010/11/17_thumb1.png" width="389" height="237" /></a> </p>  <p>This is just a simple case of applying a Macro. We can have multiple Macros in the same template and combine them to achieve powerful templates.</p>  <h4>Additional Template Options</h4>  <p>At the top of the template editor, there are two additional check boxes:</p>  <p><a href="http://hhariri.files.wordpress.com/2010/11/183.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="18" border="0" alt="18" src="http://hhariri.files.wordpress.com/2010/11/18_thumb1.png" width="364" height="84" /></a> </p>  <p>The first one is used to indicate whether we want the template to be reformatted according to the defined styles we have set up in ReSharper once completed. The second option is useful when we are referencing namespaces that are not in the using directives. Let’s imagine for instance that we generate a template to spit out some Unit Test fixtures for NUnit. If we were to decorate the class with a [TestCase] attribute in a blank file, ReSharper would indicate an error saying the the namespace is not imported. The way to solve this issue is to fully qualify the attribute when defining the template and select this checkbox. ReSharper will then make sure it imports the correct namespaces and shorten the attribute.</p>  <p><a href="http://hhariri.files.wordpress.com/2010/11/192.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="19" border="0" alt="19" src="http://hhariri.files.wordpress.com/2010/11/19_thumb.png" width="244" height="148" /></a> </p>  <p>&#160;</p>  <h3>Sharing Templates</h3>  <p>Any template created under the User Templates is visible to the current Windows user for any solution. If we want to have templates specific to a particular solution, we would need to create them under the <strong>Personal Solution Templates</strong>. These however again are restricted to the current user. If we want them shared across multiple users we need to place them under <strong>Shared Solution Templates</strong>.</p>  <p>When it comes to sharing templates across machines with team members, the cumbersome way would be to export templates and have each team member import it. The preferable way is to place these templates under network drive and then mount them using the <strong>Mount File Storage</strong></p>  <p><a href="http://hhariri.files.wordpress.com/2010/11/202.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="20" border="0" alt="20" src="http://hhariri.files.wordpress.com/2010/11/20_thumb.png" width="377" height="135" /></a> </p>  <p>By doing this, ReSharper is aware that these templates are shared across machines and makes sure they are updated accordingly.</p>  <h3>Summary</h3>  <p>Live Templates in ReSharper offer us a lot of opportunities to be more effective when writing code. It is not about code generation but about not wasting time having to type repetitive things. It is also important to understand that they should not replace good programming practices. For example, using templates to write out repetitive code for logging is not the best way to approach the problem. A better solution would be to use <a href="http://en.wikipedia.org/wiki/Aspect-oriented_programming">Aspect Orientated Programming</a>. However, there are many case where templates are very efficient. In future blog posts we’ll examine the Surround and File templates that ReSharper also offers us.</p>
